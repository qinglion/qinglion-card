<div class="min-h-screen bg-surface py-4 md:py-8">
  <div class="container-lg mx-auto px-3 md:px-4">
    <div class="mb-4 md:mb-8">
      <h1 class="text-2xl md:text-3xl font-bold text-primary mb-1 md:mb-2">编辑信息</h1>
      <p class="text-sm md:text-base text-secondary">更新您的展示内容</p>
    </div>

    <!-- Define preview functions immediately -->
    <script>
      // Open card preview in modal overlay (called from navbar)
      window.openCardPreview = function() {
        const previewUrl = '<%= card_path(@profile.slug || @profile.id) %>';
        
        const modal = document.createElement('div');
        modal.id = 'preview-modal';
        modal.className = 'fixed inset-0 z-[100] flex items-center justify-center bg-black/80';
        modal.innerHTML = `
          <div class="relative w-full h-full max-w-md mx-auto bg-white shadow-2xl flex flex-col">
            <div class="flex-shrink-0 bg-white border-b border-gray-200 flex items-center justify-between px-4 py-3">
              <span class="text-sm font-medium text-gray-700">主页预览</span>
              <button onclick="closeCardPreview()" class="text-gray-500 hover:text-gray-700 transition-colors">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                </svg>
              </button>
            </div>
            <iframe src="${previewUrl}" class="flex-1 w-full" frameborder="0"></iframe>
          </div>
        `;
        
        document.body.appendChild(modal);
        document.body.style.overflow = 'hidden';
      };
      
      // Close card preview modal
      window.closeCardPreview = function() {
        const modal = document.getElementById('preview-modal');
        if (modal) {
          modal.remove();
          document.body.style.overflow = '';
        }
      };
    </script>

    <div class="card">
      <div class="card-body p-3 md:p-6">
        <%= form_with model: @profile, url: settings_dashboards_path, method: :patch, local: true, class: "space-y-4 md:space-y-6", id: "profile-form" do |form| %>
          <%= render 'shared/form_error_message', model: @profile %>

          <!-- Basic Information -->
          <div class="space-y-3 md:space-y-4">
            <h2 class="text-lg md:text-xl font-semibold text-primary border-b border-border pb-2">基本信息</h2>
            
            <!-- Avatar -->
            <div>
              <%= form.label :avatar, '头像', class: "form-label" %>
              
              <% if @profile.avatar.attached? %>
                <div class="mb-4">
                  <div class="flex items-center gap-4">
                    <div class="avatar avatar-lg">
                      <%= optimized_image_tag @profile.avatar, alt: @profile.full_name, class: "w-full h-full object-cover", size: [200, 200] %>
                    </div>
                    <div class="text-sm text-secondary">
                      当前头像
                    </div>
                  </div>
                </div>
              <% end %>
              
              <%= form.file_field :avatar, accept: "image/*", class: "form-input" %>
              <div class="form-help">支持 JPG、PNG、GIF 等图片格式，建议尺寸 400x400 像素</div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <div>
                <%= form.label :full_name, '姓名', class: "form-label" %>
                <%= form.text_field :full_name, required: true, class: "form-input", placeholder: "请输入您的姓名" %>
              </div>

              <div>
                <%= form.label :title, class: "form-label" do %>
                  让别人一句话记住我 <span class="text-error">*</span>
                <% end %>
                <p class="text-muted text-sm mb-2">将显示在名字下方，例如：主任医师 | 20年临床经验的心血管专家</p>
                <%= form.text_field :title, required: true, class: "form-input", placeholder: "请输入您的专业头衔和特色亮点" %>
              </div>
            </div>

            <div>
              <%= form.label :location, '所在地', class: "form-label" %>
              <%= form.text_field :location, class: "form-input", placeholder: "例如：北京·朝阳" %>
            </div>

            
            
            
          </div>

          <!-- Contact Information -->
          

          <!-- Profile Details -->
          <div class="space-y-3 md:space-y-4">
            <h2 class="text-lg md:text-xl font-semibold text-primary border-b border-border pb-2">个人故事</h2>
            
            <div>
              <%= form.label :bio, '讲述你的故事，并回答三个核心问题', class: "form-label" %>
              <div class="space-y-1 mb-2">
                <p class="text-muted text-xs md:text-sm">• 你能帮助客户解决什么问题？</p>
                <p class="text-muted text-xs md:text-sm">• 你能为客户带来什么核心价值？</p>
                <p class="text-muted text-xs md:text-sm">• 你能帮助客户实现什么梦想？</p>
              </div>
              <%= form.text_area :bio, rows: 5, class: "form-input", placeholder: "例如：我曾经也是一名普通的创业者，经历过无数次失败后，我意识到...

现在，我帮助像当年的自己一样的创业者：
• 解决：品牌定位模糊、客户获取困难的问题
• 价值：提供系统化的品牌策略，让你的产品脱颖而出
• 梦想：实现你的事业突破，打造属于自己的品牌帝国" %>
            </div>
          </div>

          <!-- Service Advantages -->
          <div class="space-y-3 md:space-y-4">
            <h2 class="text-lg md:text-xl font-semibold text-primary border-b border-border pb-2">你的3大独特优势</h2>
            <p class="text-xs md:text-sm text-secondary">展示您的专业服务优势（最多3条），未填写则不显示</p>
            
            <% [1, 2, 3].each do |i| %>
              <div class="p-3 md:p-4 bg-surface-elevated rounded-lg">
                <h3 class="text-sm font-semibold text-primary mb-2 md:mb-3">优势 <%= i %></h3>
                <div class="space-y-2 md:space-y-3">
                  <div>
                    <%= form.label "service_advantage_#{i}_title", '标题', class: "form-label" %>
                    <%= form.text_field "service_advantage_#{i}_title", class: "form-input", placeholder: "例如：专业经验丰富" %>
                  </div>
                  <div>
                    <%= form.label "service_advantage_#{i}_description", '描述', class: "form-label" %>
                    <%= form.text_area "service_advantage_#{i}_description", rows: 2, class: "form-input", placeholder: "描述这个优势的具体内容..." %>
                  </div>
                </div>
              </div>
            <% end %>
          </div>



          <!-- Case Studies -->
          <div id="case-studies-container" class="space-y-3 md:space-y-4">
            <h2 class="text-lg md:text-xl font-semibold text-primary border-b border-border pb-2">成功案例</h2>
            <p class="text-xs md:text-sm text-secondary">展示您的专业成功案例，未填写则不显示</p>
            
            <% 
              # Prepare case studies array with at least 3 items for new profiles
              case_studies_array = @profile.case_studies.to_a
              while case_studies_array.size < 3
                case_studies_array << @profile.case_studies.build
              end
            %>
            
            <%= form.fields_for :case_studies, case_studies_array do |case_form| %>
              <div class="p-3 md:p-4 bg-surface-elevated rounded-lg case-study-item">
                <div class="flex justify-between items-center mb-2 md:mb-3">
                  <h3 class="text-sm font-semibold text-primary">案例 <%= case_form.index + 1 %></h3>
                  <% if case_form.object.persisted? %>
                    <button type="button" 
                            onclick="removeCaseStudy(this)"
                            class="text-error hover:text-error-dark text-xs">
                      删除
                    </button>
                    <%= case_form.hidden_field :_destroy, class: 'destroy-flag' %>
                  <% end %>
                </div>
                <div class="space-y-2 md:space-y-3">
                  <div class="grid grid-cols-1 md:grid-cols-2 gap-2 md:gap-3">
                    <div>
                      <%= case_form.label :title, '案例标题', class: "form-label" %>
                      <%= case_form.text_field :title, class: "form-input", placeholder: "例如：某科技公司股权转让纠纷案" %>
                    </div>
                    <div>
                      <%= case_form.label :category, '案件分类', class: "form-label" %>
                      <%= case_form.text_field :category, class: "form-input", placeholder: "例如：股权争议、并购重组" %>
                    </div>
                  </div>
                  <div>
                    <%= case_form.label :date, '案件日期', class: "form-label" %>
                    <%= case_form.text_field :date, class: "form-input", placeholder: "例如：2023年6月" %>
                  </div>
                  <div>
                    <%= case_form.label :description, '案例描述', class: "form-label" %>
                    <%= case_form.text_area :description, rows: 3, class: "form-input", placeholder: "详细描述案件背景、处理过程和结果，例如：成功代理某科技公司股东回股权转让纠纷，涉案金额3500万元..." %>
                  </div>
                  <%= case_form.hidden_field :position %>
                </div>
              </div>
            <% end %>
            
            <button type="button" 
                    onclick="addCaseStudy()"
                    class="btn-outline-sm w-full">
              <svg class="w-4 h-4 inline mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"/>
              </svg>
              添加更多案例
            </button>
          </div>

          <!-- Honors -->
          <div id="honors-container" class="space-y-3 md:space-y-4">
            <h2 class="text-lg md:text-xl font-semibold text-primary border-b border-border pb-2">荣誉认证</h2>
            <p class="text-xs md:text-sm text-secondary">展示您的荣誉和认证，未填写则不显示</p>
            
            <% 
              # Prepare honors array with at least 3 items for new profiles
              honors_array = @profile.honors.to_a
              while honors_array.size < 3
                honors_array << @profile.honors.build
              end
            %>
            
            <%= form.fields_for :honors, honors_array do |honor_form| %>
              <div class="p-3 md:p-4 bg-surface-elevated rounded-lg honor-item">
                <div class="flex justify-between items-center mb-2 md:mb-3">
                  <h3 class="text-sm font-semibold text-primary">荣誉 <%= honor_form.index + 1 %></h3>
                  <% if honor_form.object.persisted? %>
                    <button type="button" 
                            onclick="removeHonor(this)"
                            class="text-error hover:text-error-dark text-xs">
                      删除
                    </button>
                    <%= honor_form.hidden_field :_destroy, class: 'destroy-flag' %>
                  <% end %>
                </div>
                <div class="space-y-2 md:space-y-3">
                  <div class="grid grid-cols-1 md:grid-cols-2 gap-2 md:gap-3">
                    <div>
                      <%= honor_form.label :title, '荣誉标题', class: "form-label" %>
                      <%= honor_form.text_field :title, class: "form-input", placeholder: "例如：2023年度最佳律师" %>
                    </div>
                    <div>
                      <%= honor_form.label :organization, '颁发机构', class: "form-label" %>
                      <%= honor_form.text_field :organization, class: "form-input", placeholder: "例如：中国律师协会" %>
                    </div>
                  </div>
                  <div>
                    <%= honor_form.label :date, '获得日期', class: "form-label" %>
                    <%= honor_form.text_field :date, class: "form-input", placeholder: "例如：2023年" %>
                  </div>
                  <div>
                    <%= honor_form.label :description, '详细描述', class: "form-label" %>
                    <%= honor_form.text_area :description, rows: 2, class: "form-input", placeholder: "详细描述荣誉的背景和意义（可选）" %>
                  </div>
                </div>
              </div>
            <% end %>
            
            <button type="button" 
                    onclick="addHonor()"
                    class="btn-outline-sm w-full">
              <svg class="w-4 h-4 inline mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"/>
              </svg>
              添加更多荣誉
            </button>
          </div>

          <!-- Service Process -->
          

          <!-- Professional Stats -->
          <div class="space-y-3 md:space-y-4">
            <h2 class="text-lg md:text-xl font-semibold text-primary border-b border-border pb-2">专业数据</h2>
            
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
              <div>
                <%= form.label 'stats[years_experience]', '执业年限（年）', class: "form-label" %>
                <%= number_field_tag 'profile[stats][years_experience]', 
                    @profile.stats&.dig('years_experience'), 
                    class: "form-input", min: 0, placeholder: "0" %>
              </div>

              <div>
                <%= form.label 'stats[cases_handled]', '成功案例数', class: "form-label" %>
                <%= number_field_tag 'profile[stats][cases_handled]', 
                    @profile.stats&.dig('cases_handled'), 
                    class: "form-input", min: 0, placeholder: "0" %>
              </div>

              <div>
                <%= form.label 'stats[clients_served]', '服务客户数', class: "form-label" %>
                <%= number_field_tag 'profile[stats][clients_served]', 
                    @profile.stats&.dig('clients_served'), 
                    class: "form-input", min: 0, placeholder: "0" %>
              </div>

              <div>
                <%= form.label 'stats[success_rate]', '成功率（%）', class: "form-label" %>
                <%= number_field_tag 'profile[stats][success_rate]', 
                    @profile.stats&.dig('success_rate'), 
                    class: "form-input", min: 0, max: 100, placeholder: "0" %>
              </div>
            </div>
          </div>

          <!-- Testimonials -->
          <div id="testimonials-container" class="space-y-3 md:space-y-4">
            <h2 class="text-lg md:text-xl font-semibold text-primary border-b border-border pb-2">客户评价</h2>
            <p class="text-xs md:text-sm text-secondary">展示客户的真实评价，增强信任感，未填写则不显示</p>
            
            <% 
              # Ensure testimonials is a valid array of hashes
              testimonials_data = @profile.testimonials || {}
              
              # Convert Hash to Array if needed (Rails sometimes stores as Hash with numeric string keys)
              if testimonials_data.is_a?(Hash)
                testimonials_array = testimonials_data.values
              elsif testimonials_data.is_a?(Array)
                testimonials_array = testimonials_data
              else
                testimonials_array = []
              end
              
              # Ensure each item is a hash, filter out invalid items
              testimonials_array = testimonials_array.select { |t| t.is_a?(Hash) }
              
              # Ensure minimum 3 items
              while testimonials_array.size < 3
                testimonials_array << { 'name' => '', 'title' => '', 'content' => '', 'rating' => 5 }
              end
            %>
            
            <% testimonials_array.each_with_index do |testimonial, index| %>
              <div class="p-3 md:p-4 bg-surface-elevated rounded-lg">
                <div class="flex justify-between items-center mb-2 md:mb-3">
                  <h3 class="text-sm font-semibold text-primary">评价 <%= index + 1 %></h3>
                </div>
                <div class="space-y-2 md:space-y-3">
                  <div class="grid grid-cols-1 md:grid-cols-2 gap-2 md:gap-3">
                    <div>
                      <%= form.label "testimonials[#{index}][name]", '客户姓名', class: "form-label" %>
                      <%= text_field_tag "profile[testimonials][#{index}][name]", testimonial['name'], class: "form-input", placeholder: "例如：张三" %>
                    </div>
                    <div>
                      <%= form.label "testimonials[#{index}][title]", '客户职位/公司', class: "form-label" %>
                      <%= text_field_tag "profile[testimonials][#{index}][title]", testimonial['title'], class: "form-input", placeholder: "例如：XX科技CEO" %>
                    </div>
                  </div>
                  <div>
                    <%= form.label "testimonials[#{index}][content]", '评价内容', class: "form-label" %>
                    <%= text_area_tag "profile[testimonials][#{index}][content]", testimonial['content'], rows: 3, class: "form-input", placeholder: "客户的评件内容，例如：非常专业的服务，帮助我们解决了很多问题..." %>
                  </div>
                  <div>
                    <%= form.label "testimonials[#{index}][rating]", '评分（1-5星）', class: "form-label" %>
                    <%= number_field_tag "profile[testimonials][#{index}][rating]", testimonial['rating'] || 5, class: "form-input", min: 1, max: 5, placeholder: "5" %>
                  </div>
                </div>
              </div>
            <% end %>
            
            <button type="button" 
                    onclick="addTestimonial()"
                    class="btn-outline-sm w-full">
              <svg class="w-4 h-4 inline mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"/>
              </svg>
              添加更多评价
            </button>
          </div>

          <!-- CTA (Call to Action) -->
          <div class="space-y-3 md:space-y-4">
            <h2 class="text-lg md:text-xl font-semibold text-primary border-b border-border pb-2">行动号召</h2>
            <p class="text-xs md:text-sm text-secondary">在名片底部展示的行动号召区域，未填写则不显示</p>
            
            <div class="p-3 md:p-4 bg-surface-elevated rounded-lg space-y-2 md:space-y-3">
              <div>
                <%= form.label :cta_title, '标题', class: "form-label" %>
                <%= form.text_field :cta_title, class: "form-input", placeholder: "例如：准备好开始合作了吗？" %>
              </div>
              <div>
                <%= form.label :cta_description, '描述', class: "form-label" %>
                <%= form.text_area :cta_description, rows: 2, class: "form-input", placeholder: "引导访客采取行动的描述文字..." %>
              </div>
              <div>
                <%= form.label :cta_qrcode, '行动二维码（例如：微信二维码、公众号二维码）', class: "form-label" %>
                <p class="text-muted text-xs mb-2">上传二维码图片，引导用户扫码添加联系方式</p>
                <%= form.file_field :cta_qrcode, accept: 'image/*', class: "form-input" %>
                <% if @profile.cta_qrcode.attached? %>
                  <div class="mt-2 flex items-center gap-2">
                    <%= image_tag @profile.cta_qrcode, class: "w-24 h-24 object-cover rounded border border-border" %>
                    <span class="text-xs text-secondary">已上传</span>
                  </div>
                <% end %>
              </div>
            </div>
          </div>

          <!-- Form Actions -->
          <div class="h-16 md:h-20"></div>
        <% end %>
      </div>
    </div>
  </div>

  <!-- Builder Attribution -->
  <%= render 'shared/footer_attribution' %>
  
  <!-- Fixed Bottom Actions Bar -->
  <div class="fixed bottom-0 left-0 right-0 bg-surface border-t border-border shadow-lg z-50">
    <div class="container-lg mx-auto px-3 md:px-4 py-3 md:py-4">
      <div class="flex justify-center items-center">
        <!-- Save Button -->
        <%= button_tag type: "submit", form: "profile-form", class: "btn-primary text-sm md:text-base" do %>
          <svg class="w-4 h-4 md:w-5 md:h-5 inline mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
          </svg>
          保存更改
        <% end %>
      </div>
    </div>
  </div>
</div>

<% content_for :additional_scripts do %>
<script>
  // Add padding to body when fixed bar is present
  document.addEventListener('DOMContentLoaded', function() {
    const fixedBar = document.querySelector('.fixed.bottom-0');
    if (fixedBar) {
      document.body.style.paddingBottom = fixedBar.offsetHeight + 'px';
    }
  });
  
  // Add new case study function
  function addCaseStudy() {
    const container = document.getElementById('case-studies-container');
    if (!container) return;
    
    const existingItems = container.querySelectorAll('.case-study-item');
    const newIndex = existingItems.length;
    const timestamp = new Date().getTime();
    
    const addButton = container.querySelector('button[onclick="addCaseStudy()"]');
    
    const newItemHTML = `
      <div class="p-3 md:p-4 bg-surface-elevated rounded-lg case-study-item">
        <div class="flex justify-between items-center mb-2 md:mb-3">
          <h3 class="text-sm font-semibold text-primary">案例 ${newIndex + 1}</h3>
          <button type="button" 
                  onclick="removeCaseStudy(this)"
                  class="text-error hover:text-error-dark text-xs">
            删除
          </button>
        </div>
        <div class="space-y-2 md:space-y-3">
          <div class="grid grid-cols-1 md:grid-cols-2 gap-2 md:gap-3">
            <div>
              <label class="form-label">案例标题</label>
              <input type="text" name="profile[case_studies_attributes][${timestamp}][title]" class="form-input" placeholder="例如：某科技公司股权转让纠纷案">
            </div>
            <div>
              <label class="form-label">案件分类</label>
              <input type="text" name="profile[case_studies_attributes][${timestamp}][category]" class="form-input" placeholder="例如：股权争议、并购重组">
            </div>
          </div>
          <div>
            <label class="form-label">案件日期</label>
            <input type="text" name="profile[case_studies_attributes][${timestamp}][date]" class="form-input" placeholder="例如：2023年6月">
          </div>
          <div>
            <label class="form-label">案例描述</label>
            <textarea name="profile[case_studies_attributes][${timestamp}][description]" rows="3" class="form-input" placeholder="详细描述案件背景、处理过程和结果，例如：成功代理某科技公司股东回股权转让纠纷，涉案金额3500万元..."></textarea>
          </div>
          <input type="hidden" name="profile[case_studies_attributes][${timestamp}][position]" value="${newIndex}">
        </div>
      </div>
    `;
    
    addButton.insertAdjacentHTML('beforebegin', newItemHTML);
  }
  
  // Remove case study function
  function removeCaseStudy(button) {
    const item = button.closest('.case-study-item');
    const destroyFlag = item.querySelector('.destroy-flag');
    
    if (destroyFlag) {
      // For persisted records, set _destroy flag
      destroyFlag.value = '1';
      item.style.display = 'none';
    } else {
      // For new records, just remove the element
      item.remove();
    }
  }
  
  // Add new honor function
  function addHonor() {
    const container = document.getElementById('honors-container');
    if (!container) return;
    
    const existingItems = container.querySelectorAll('.honor-item');
    const newIndex = existingItems.length;
    const timestamp = new Date().getTime();
    
    const addButton = container.querySelector('button[onclick="addHonor()"]');
    
    const newItemHTML = `
      <div class="p-3 md:p-4 bg-surface-elevated rounded-lg honor-item">
        <div class="flex justify-between items-center mb-2 md:mb-3">
          <h3 class="text-sm font-semibold text-primary">荣誉 ${newIndex + 1}</h3>
          <button type="button" 
                  onclick="removeHonor(this)"
                  class="text-error hover:text-error-dark text-xs">
            删除
          </button>
        </div>
        <div class="space-y-2 md:space-y-3">
          <div class="grid grid-cols-1 md:grid-cols-2 gap-2 md:gap-3">
            <div>
              <label class="form-label">荣誉标题</label>
              <input type="text" name="profile[honors_attributes][${timestamp}][title]" class="form-input" placeholder="例如：2023年度最佳律师">
            </div>
            <div>
              <label class="form-label">颁发机构</label>
              <input type="text" name="profile[honors_attributes][${timestamp}][organization]" class="form-input" placeholder="例如：中国律师协会">
            </div>
          </div>
          <div>
            <label class="form-label">获得日期</label>
            <input type="text" name="profile[honors_attributes][${timestamp}][date]" class="form-input" placeholder="例如：2023年">
          </div>
          <div>
            <label class="form-label">详细描述</label>
            <textarea name="profile[honors_attributes][${timestamp}][description]" rows="2" class="form-input" placeholder="详细描述荣誉的背景和意义（可选）"></textarea>
          </div>
        </div>
      </div>
    `;
    
    addButton.insertAdjacentHTML('beforebegin', newItemHTML);
  }
  
  // Remove honor function
  function removeHonor(button) {
    const item = button.closest('.honor-item');
    const destroyFlag = item.querySelector('.destroy-flag');
    
    if (destroyFlag) {
      // For persisted records, set _destroy flag
      destroyFlag.value = '1';
      item.style.display = 'none';
    } else {
      // For new records, just remove the element
      item.remove();
    }
  }
  
  // Add new testimonial function
  function addTestimonial() {
    const testimonialsContainer = document.getElementById('testimonials-container');
    if (!testimonialsContainer) return;
    
    const existingTestimonials = testimonialsContainer.querySelectorAll('.bg-surface-elevated.rounded-lg');
    const newIndex = existingTestimonials.length;
    
    const addButton = testimonialsContainer.querySelector('button[onclick="addTestimonial()"]');
    
    const newTestimonialHTML = `
      <div class="p-3 md:p-4 bg-surface-elevated rounded-lg">
        <div class="flex justify-between items-center mb-2 md:mb-3">
          <h3 class="text-sm font-semibold text-primary">评价 ${newIndex + 1}</h3>
        </div>
        <div class="space-y-2 md:space-y-3">
          <div class="grid grid-cols-1 md:grid-cols-2 gap-2 md:gap-3">
            <div>
              <label class="form-label">客户姓名</label>
              <input type="text" name="profile[testimonials][${newIndex}][name]" class="form-input" placeholder="例如：张三">
            </div>
            <div>
              <label class="form-label">客户职位/公司</label>
              <input type="text" name="profile[testimonials][${newIndex}][title]" class="form-input" placeholder="例如：XX科技CEO">
            </div>
          </div>
          <div>
            <label class="form-label">评价内容</label>
            <textarea name="profile[testimonials][${newIndex}][content]" rows="3" class="form-input" placeholder="客户的评件内容，例如：非常专业的服务，帮助我们解决了很多问题..."></textarea>
          </div>
          <div>
            <label class="form-label">评分（1-5星）</label>
            <input type="number" name="profile[testimonials][${newIndex}][rating]" class="form-input" min="1" max="5" placeholder="5" value="5">
          </div>
        </div>
      </div>
    `;
    
    addButton.insertAdjacentHTML('beforebegin', newTestimonialHTML);
  }
</script>
<% end %>
